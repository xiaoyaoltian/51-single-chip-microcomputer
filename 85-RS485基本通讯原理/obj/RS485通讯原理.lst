C51 COMPILER V9.54   RS485________                                                         08/26/2018 15:15:02 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE RS485________
OBJECT MODULE PLACED IN .\obj\RS485通讯原理.obj
COMPILER INVOKED BY: d:\Keil_v5\C51\BIN\C51.EXE RS485通讯原理.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\obj\
                    -RS485通讯原理.lst) TABS(2) OBJECT(.\obj\RS485通讯原理.obj)

line level    source

   1          /*******************************************************************************
   2          * 版  权  : 红梅科技工作室
   3          * 论  坛  ：https://blog.csdn.net/Qingzhusshuiyun
   4          * Q Q     ：2369099714
   5          * 版权所有，盗版必究。
   6          * 工  程   : RS485通讯原理
   7          * 文件名   : RS485通讯原理.c
   8          * 处理器   : STC89C52RC
   9          * 编译环境 : Keil 5
  10          * 系统时钟 : 12MHZ
  11          * 版    本  : V1.0 
  12          * 生成日期  : 2018-07-25              
  13          * 修改日期  :  
  14          * 简单描述 : 485 与 232 使用相同软件协议，是半双工，需要有2套开发板对发测试，或者使用
  15                  另外一个485设备配套，这里提供测试程序
  16          *******************************************************************************/
  17           
  18          #include<reg52.h> //包含头文件，一般情况不需要改动，头文件包含特殊功能寄存器的定义                        
  19          #include"delay.h"
  20          /*------------------------------------------------
  21                          硬件端口定义
  22          ------------------------------------------------*/
  23          sbit Ctrl_EN = P2^0;  //发送接收控制端
  24          /*------------------------------------------------
  25                           函数声明
  26          ------------------------------------------------*/
  27          void SendStr(unsigned char *s);
  28          /*------------------------------------------------
  29                          串口初始化
  30          ------------------------------------------------*/
  31          void InitUART  (void)
  32          {
  33   1      
  34   1          SCON  = 0x50;           // SCON: 模式 1, 8-bit UART, 使能接收  
  35   1          TMOD |= 0x20;               // TMOD: timer 1, mode 2, 8-bit 重装
  36   1          TH1   = 0xFD;               // TH1:  重装值 9600 波特率 晶振 11.0592MHz  
  37   1          TR1   = 1;                  // TR1:  timer 1 打开                         
  38   1          EA    = 1;                  //打开总中断
  39   1          //ES    = 1;                  //打开串口中断
  40   1      }                            
  41          /*------------------------------------------------
  42                              主函数
  43          ------------------------------------------------*/
  44          void main (void)
  45          {
  46   1      
  47   1      InitUART();
  48   1      
  49   1      Ctrl_EN=1;  //发送模式
  50   1      
  51   1      while (1)                       
  52   1          {
  53   2          SendStr("UART test，技术论坛：www.doflye.net thank you!");
  54   2        DelayMs(240);//延时循环发送
C51 COMPILER V9.54   RS485________                                                         08/26/2018 15:15:02 PAGE 2   

  55   2          DelayMs(240);
  56   2          }
  57   1      }
  58          
  59          /*------------------------------------------------
  60                              发送一个字节
  61          ------------------------------------------------*/
  62          void SendByte(unsigned char dat)
  63          {
  64   1       SBUF = dat;
  65   1       while(!TI);
  66   1            TI = 0;
  67   1      }
  68          /*------------------------------------------------
  69                              发送一个字符串
  70          ------------------------------------------------*/
  71          void SendStr(unsigned char *s)
  72          {
  73   1       while(*s!='\0')// \0 表示字符串结束标志，通过检测是否字符串末尾
  74   1        {
  75   2        SendByte(*s);
  76   2        s++;
  77   2        }
  78   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     67    ----
   CONSTANT SIZE    =     47    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
